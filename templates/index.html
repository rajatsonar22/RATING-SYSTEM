<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Team Ratings</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { 
            font-family: 'Roboto', sans-serif;
            text-align: center;
            background-color: black;
            color: white;
            margin: 0;
            padding: 0;
        }

        .logo {
            position: fixed;
            top: 10px;
            width: 40px;
            height: 40px;
            z-index: 1000;
        }
        .logo-left { left: 10px; }
        .logo-right { right: 10px; }

        h1 {
            margin-top: 60px;
            font-size: 24px;
        }

        .team-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            padding: 10px;
        }

        .team {
            width: 90%;
            max-width: 450px;
            margin: 15px;
            padding: 15px;
            background: #3498db;
            color: black;
            border-radius: 10px;
            text-align: center;
            transition: 0.3s ease;
        }
        #admin

        .team:hover { transform: scale(1.05); }
        .rating-container { display: flex; justify-content: center; margin-top: 10px; }
        .stars span { font-size: 25px; cursor: pointer; color: gray; padding: 5px; }
        .stars span:hover, .stars span.active { color: gold; }

        .check-results {
            margin-top: 30px;
            padding: 20px;
            background: #222;
            border-radius: 10px;
            width: 90%;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
        }

        .check-results input, .check-results button {
            padding: 10px;
            width: 100%;
            margin-top: 10px;
            border-radius: 5px;
            border: none;
        }

        .check-results input { background: #fff; color: black; }
        .check-results button { background: #3498db; color: white; font-weight: bold; cursor: pointer; }
        .check-results button:hover { background: #2980b9; }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            background: white;
            color: black;
            border-radius: 10px;
        }

        table, th, td { border: 1px solid black; }
        th, td { padding: 10px; text-align: center; }

        @media (max-width: 768px) {
            .team { width: 95%; }
            .logo { width: 35px; height: 35px; }
            h1 { font-size: 20px; }
        }
    </style>
</head>
<body>
    <img src="{{ url_for('static', filename='tilak_logo.png') }}" alt="Tilak Logo" class="logo logo-left">
    <img src="{{ url_for('static', filename='innovators_logo.png') }}" alt="Innovators Logo" class="logo logo-right">

    <h1>Select a Topic to Rate</h1>
    <div class="team-container"></div>

    <div class="check-results">
        <h2>Check Results</h2>
        <input type="password" id="adminKey" placeholder="Enter Admin Key">
        <button onclick="checkResults()">Check</button>
        <div id="results"></div>
    </div>

    <script>
        const topics = [
            "PPT Presentation",
            "AI Deepfake Voice Detection",
            "Intelligent Job Classification & Notifications",
            "Health Coach",
            "Intelligent Learner Management System",
            "Shopsphere (ParkPay)",
            "Currency Detection for Visually Impaired",
            "Remote Interview",
            "Hospital Management System",
            "HUD Integrated Helmet",
            "Deepfake Detection System",
            "Healthy Bites",
            "Doc Tech",
            "Custom Operating System",
            "Eco-System",
            "QURA: The Signware"
        ];

        const container = document.querySelector(".team-container");

        topics.forEach((topic, index) => {
            let div = document.createElement("div");
            div.className = "team";
            div.innerHTML = `
                <div class="team-description">
                    <h2>${topic}</h2>
                    <div>Your description here</div>
                </div>
                <div class="rating-container">
                    <div class="stars" data-topic="${topic}">
                        <span data-value="1">★</span>
                        <span data-value="2">★</span>
                        <span data-value="3">★</span>
                        <span data-value="4">★</span>
                        <span data-value="5">★</span>
                    </div>
                </div>
            `;
            container.appendChild(div);
        });

        document.addEventListener("click", function (event) {
            if (event.target.matches(".stars span")) {
                let star = event.target;
                let ratingContainer = star.parentElement;
                let selectedRating = star.getAttribute("data-value");
                let allStars = ratingContainer.querySelectorAll("span");
                allStars.forEach(s => s.classList.remove("active"));
                for (let i = 0; i < selectedRating; i++) { allStars[i].classList.add("active"); }
                let topic = ratingContainer.getAttribute("data-topic");
                fetch("/rate", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ team: topic, rating: selectedRating })
                });
            }
        });

        function checkResults() {
            const key = document.getElementById("adminKey").value;
            if (!key) { alert("Please enter the admin key!"); return; }
            fetch("/check_votes", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ key: key })
            })
            .then(response => response.json())
            .then(data => {
                if (data.error) {
                    alert(data.error);
                } else {
                    let resultHtml = `<table><tr><th>Topic</th><th>Votes</th></tr>`;
                    for (let team in data) {
                        resultHtml += `<tr><td>${team}</td><td>${data[team].votes}</td></tr>`;
                    }
                    resultHtml += `</table>`;
                    document.getElementById("results").innerHTML = resultHtml;
                }
            });
        }
    </script>
</body>
</html>
