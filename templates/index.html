<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Team Ratings</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { 
            font-family: 'Roboto', sans-serif;
            text-align: center; 
            background-color: #121212; 
            color: white; 
            padding: 20px;
        }
        .container {
            max-width: 800px;
            margin: auto;
        }
        .team-container { 
            margin-top: 20px; 
        }
        .team { 
            width: 100%;
            max-width: 700px;
            height: 120px;
            margin: 20px auto;
            padding: 20px;
            background: #1E88E5;
            color: white;
            border-radius: 12px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 8px rgba(255, 255, 255, 0.2);
        }
        .team-description { 
            text-align: left;
            flex-grow: 1;
        }
        .rating-container {
            display: flex;
            gap: 10px;
        }
        .stars span {
            font-size: 30px;
            cursor: pointer;
            color: gray;
        }
        .stars span:hover, .stars span.active {
            color: gold;
        }
        /* Admin Section */
        .admin-container {
            margin-top: 40px;
            padding: 20px;
            background: #333;
            border-radius: 10px;
        }
        input, button {
            padding: 10px;
            font-size: 16px;
            margin: 5px;
            border-radius: 6px;
            border: none;
        }
        button {
            background-color: #E91E63;
            color: white;
            cursor: pointer;
        }
        button:hover {
            background-color: #C2185B;
        }
    </style>
</head>
<body>

    <h1>Rate Your Favorite Project</h1>

    <div class="container">
        <div class="team-container">
            <!-- Teams will be generated dynamically -->
        </div>
        
        <!-- Admin Section -->
        <div class="admin-container">
            <h2>Check Total Votes</h2>
            <input type="password" id="adminKey" placeholder="Enter Secret Key">
            <button onclick="checkVotes()">Check</button>
            <p id="voteCount"></p>
        </div>
    </div>

    <script>
        const topics = [
            "PPT Presentation",
            "AI Deepfake Voice Detection",
            "Intelligent Job Classification and Notifications Using Placement Data​",
            "Health Coach: Your Personal Health Companion",
            "Intelligent Learner Management System",
            "Shopsphere (ParkPay)",
            "Currency Detection for Visually Impaired",
            "Remote Interview",
            "Hospital Management System",
            "HUD Integrated Helmet",
            "Deepfake Detection System",
            "Healthy Bites",
            "Doc Tech",
            "Custom Operating System for Effective Learning",
            "Eco-System",
            "QURA: The Signware"
        ];
        
        const container = document.querySelector(".team-container");

        // Generate teams dynamically
        topics.forEach((topic, index) => {
            let div = document.createElement("div");
            div.className = "team";
            div.innerHTML = `
                <div class="team-description">
                    <h2>${topic}</h2>
                    <div>Your description here</div>
                </div>
                <div class="rating-container" id="ratingContainer-${index}">
                    <div class="stars" data-team="${topic}">
                        <span data-value="1">★</span>
                        <span data-value="2">★</span>
                        <span data-value="3">★</span>
                        <span data-value="4">★</span>
                        <span data-value="5">★</span>
                    </div>
                </div>
            `;
            div.onclick = () => rateTeam(topic);
            container.appendChild(div);
        });

        // Handle Star Selection and Rating Submission
        function rateTeam(topic) {
            const stars = document.querySelectorAll(`[data-team="${topic}"] span`);
            let selectedRating = 0;

            stars.forEach(star => {
                star.onclick = function () {
                    selectedRating = this.getAttribute("data-value");
                    stars.forEach(s => s.classList.remove("active"));
                    for (let i = 0; i < selectedRating; i++) {
                        stars[i].classList.add("active");
                    }

                    // Submit Rating to Backend
                    fetch("/rate", {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify({ team: topic, rating: selectedRating })
                    })
                    .then(response => response.json())
                    .then(data => {
                        alert(data.message);
                    })
                    .catch(error => console.error("Error:", error));
                };
            });
        }

        // Check Votes Function
        function checkVotes() {
            const key = document.getElementById("adminKey").value;

            fetch("/check_votes", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ key: key })
            })
            .then(response => response.json())
            .then(data => {
                if (data.error) {
                    alert(data.error);
                } else {
                    document.getElementById("voteCount").innerText = `Total Votes: ${data.total_votes}`;
                }
            })
            .catch(error => console.error("Error:", error));
        }
    </script>

</body>
</html>
